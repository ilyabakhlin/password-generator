<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Password Generator</title>
    </head>
    <body>
        <main>
            <div>
                <label for="password-length">Length:</label>
                <input id="password-length" name="password-length" type="number" value="16">
            </div>
            <p></p>
            <button>Generate</button>
        </main>
    </body>
    <script>
        const SPECIAL_CHARACTERS = ["!", "@", "#", "$", "%", "^", "&", "-", "_", "=", "+", "<", ">", "(", ")", "[", "]", "{", "}", "/"];

        function getCharacterLower() {
            const number = new BigUint64Array(1);
            for (const numberRandom of window.crypto.getRandomValues(number)) {
                const module = numberRandom % 123n;
                if (module < 97n) {
                    return getCharacterLower();
                } else {
                    return String.fromCharCode(Number(module));
                }
            }
        }

        function getCharacterUpper() {
            const number = new BigUint64Array(1);
            for (const numberRandom of window.crypto.getRandomValues(number)) {
                const module = numberRandom % 91n;
                if (module < 65n) {
                    return getCharacterUpper();
                } else {
                    return String.fromCharCode(Number(module));
                }
            }
        }

        function getNumbers() {
            const number = new BigUint64Array(1);
            for (const numberRandom of window.crypto.getRandomValues(number)) {
                const module = numberRandom % 58n;
                if (module < 48n) {
                    return getNumbers();
                } else {
                    return String.fromCharCode(Number(module));
                }
            }
        }

        function getCharacterSpecial() {
            const number = new BigUint64Array(1);
            for (const numberRandom of window.crypto.getRandomValues(number)) {
                return SPECIAL_CHARACTERS[numberRandom % BigInt(SPECIAL_CHARACTERS.length)];
            }
        }

        window.addEventListener("load", () => {
            window.document.querySelector("button").addEventListener("click", () => {
                const passwordLength = window.document.querySelector("input#password-length").value;
                const length = new BigUint64Array(passwordLength);
                const password = [];
                for (const number of window.crypto.getRandomValues(length)) {
                    const bigint = number % 4n;
                    switch (bigint) {
                        case 1n:
                            password.push(getCharacterLower());
                            break;
                        case 2n:
                            password.push(getCharacterUpper());
                            break;
                        case 3n:
                            password.push(getNumbers());
                            break;
                        default:
                            password.push(getCharacterSpecial());
                            break;
                    }
                }
                window.document.querySelector("p").textContent = password.join("");
            });
        });
    </script>
</html>
